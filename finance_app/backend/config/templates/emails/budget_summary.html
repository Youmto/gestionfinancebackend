{% extends "emails/base.html" %}

{% block title %}R√©sum√© hebdomadaire - {{ app_name }}{% endblock %}

{% block header_emoji %}üìä{% endblock %}
{% block header_title %}R√©sum√© de vos budgets{% endblock %}

{% block content %}
<h2>Bonjour {{ first_name }}!</h2>

<p>Voici le r√©sum√© de vos budgets pour cette semaine :</p>

<div class="stats-grid" style="margin: 25px 0;">
    <table width="100%" cellpadding="8" cellspacing="5">
        <tr>
            <td style="text-align: center; background-color: #f0fdf4; border-radius: 8px; padding: 15px;">
                <div class="stat-value" style="color: #10B981;">{{ total_budget|floatformat:0 }}</div>
                <div class="stat-label">Budget Total (XAF)</div>
            </td>
            <td style="text-align: center; background-color: #fef3c7; border-radius: 8px; padding: 15px;">
                <div class="stat-value" style="color: #F59E0B;">{{ total_spent|floatformat:0 }}</div>
                <div class="stat-label">D√©pens√© (XAF)</div>
            </td>
            <td style="text-align: center; background-color: {% if total_remaining >= 0 %}#d1fae5{% else %}#fee2e2{% endif %}; border-radius: 8px; padding: 15px;">
                <div class="stat-value" style="color: {% if total_remaining >= 0 %}#10B981{% else %}#EF4444{% endif %};">{{ total_remaining|floatformat:0 }}</div>
                <div class="stat-label">Restant (XAF)</div>
            </td>
        </tr>
    </table>
</div>

<div style="text-align: center; margin: 20px 0;">
    <span style="font-size: 48px; font-weight: 700; color: {% if overall_percentage > 100 %}#EF4444{% elif overall_percentage > 80 %}#F59E0B{% else %}#10B981{% endif %};">
        {{ overall_percentage }}%
    </span>
    <p style="color: #6b7280; margin-top: 5px;">du budget total utilis√©</p>
</div>

<div class="divider"></div>

<h3>D√©tail par cat√©gorie</h3>

{% for budget in budgets %}
<div class="category-item" style="margin: 15px 0;">
    <span class="category-icon">{{ budget.icon }}</span>
    <div style="flex: 1;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <strong>{{ budget.name }}</strong>
            <span style="color: {% if budget.percentage > 100 %}#EF4444{% elif budget.percentage > 80 %}#F59E0B{% else %}#10B981{% endif %}; font-weight: 600;">
                {{ budget.percentage|floatformat:0 }}%
            </span>
        </div>
        <div class="progress-bar" style="margin-top: 8px;">
            <div class="progress-fill" style="width: {% if budget.percentage > 100 %}100{% else %}{{ budget.percentage }}{% endif %}%; background-color: {% if budget.percentage > 100 %}#EF4444{% elif budget.percentage > 80 %}#F59E0B{% else %}#10B981{% endif %};"></div>
        </div>
        <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 12px; color: #6b7280;">
            <span>{{ budget.spent|floatformat:0 }} / {{ budget.budget|floatformat:0 }} XAF</span>
            <span>Reste: {{ budget.remaining|floatformat:0 }} XAF</span>
        </div>
    </div>
</div>
{% empty %}
<p style="color: #6b7280; text-align: center;">Aucun budget d√©fini pour le moment.</p>
{% endfor %}

<div style="text-align: center; margin-top: 30px;">
    <a href="{{ frontend_url }}/budgets" class="btn">G√©rer mes budgets</a>
</div>
{% endblock %}